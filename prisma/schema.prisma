// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
}

// ==================== ENUMS ====================

enum BidangGerejaEnum {
  Sekretariat
  Penatalayanan
  Kategorial
  Pemberdayaan_Jemaat @map("Pemberdayaan Jemaat")
  Rumah_Tangga_Sarana @map("Rumah Tangga, Sarana, dan Prasarana")
  BP2K2
  Kebendaharaan
}

enum SubBidangPenatalayananEnum {
  Pelayanan_Umum   @map("Pelayanan Umum")
  Pelayanan_Khusus @map("Pelayanan Khusus")
}

// ==================== MODELS ====================

model users {
  id         String    @id @default(dbgenerated("'usr_' || replace(gen_random_uuid()::text, '-', '')"))
  nama       String    @db.VarChar(100)
  email      String    @unique @db.VarChar(100)
  password   String    @db.Text
  no_hp      String?   @db.VarChar(20)
  role       String    @db.VarChar(20)
  status     String?   @default("aktif") @db.VarChar(10)
  created_at DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  arsip_bulanan    arsip_bulanan[]
  jadwal_ibadah    jadwal_ibadah[]
  kegiatan_bulanan kegiatan_bulanan[]
  pengumuman       pengumuman[]
  sejarah_gereja   sejarah_gereja[]
}

model admins {
  id            String    @id @default(dbgenerated("'adm_' || replace(gen_random_uuid()::text, '-', '')"))
  nama          String    @db.VarChar(100)
  email         String    @unique @db.VarChar(150)
  password_hash String    @db.Text
  role          String    @db.VarChar(20)
  is_active     Boolean?  @default(true)
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  updated_at    DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  announcements announcements[]
  aktivitas     aktivitas[]
}

model agenda {
  id               String    @id @default(dbgenerated("'agd_' || replace(gen_random_uuid()::text, '-', '')"))
  kegiatan         String    @db.VarChar(150)
  tanggal          DateTime  @db.Date
  jam_mulai        DateTime  @db.Time(6)
  jam_selesai      DateTime? @db.Time(6)
  lokasi           String    @db.VarChar(150)
  penanggung_jawab String    @db.VarChar(150)
  status           String?   @default("aktif") @db.VarChar(20)
  is_publish       Boolean?  @default(true)
  created_by       String?
  created_at       DateTime? @default(now()) @db.Timestamp(6)
  updated_at       DateTime? @default(now()) @db.Timestamp(6)
}

model aktivitas {
  id         String    @id @default(dbgenerated("'akt_' || replace(gen_random_uuid()::text, '-', '')"))
  admin_id   String?
  admin_nama String?   @db.VarChar(100)
  aksi       String?   @db.VarChar(50)
  modul      String?   @db.VarChar(50)
  detail     String?   @db.Text
  created_at DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  admin admins? @relation(fields: [admin_id], references: [id])
}

model announcements {
  id         String    @id @default(dbgenerated("'ann_' || replace(gen_random_uuid()::text, '-', '')"))
  isi        String    @db.Text
  status     String?   @default("draft") @db.VarChar(20)
  tanggal    DateTime? @default(now()) @db.Timestamp(6)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  created_by String?

  // Relations
  admin admins? @relation(fields: [created_by], references: [id])
}

model arsip_bulanan {
  id         String    @id @default(dbgenerated("'arb_' || replace(gen_random_uuid()::text, '-', '')"))
  bulan      Int
  tahun      Int
  data       Json?
  created_by String?
  created_at DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  user users? @relation(fields: [created_by], references: [id])
}

model carousel_slides {
  id          String    @id @default(dbgenerated("'crs_' || replace(gen_random_uuid()::text, '-', '')"))
  title       String    @db.VarChar(255)
  subtitle    String?   @db.Text
  quote       String?   @db.Text
  badge       String?   @db.VarChar(255)
  image_url   String    @db.VarChar(255)
  cta_text    String?   @db.VarChar(100)
  cta_link    String?   @db.VarChar(255)
  order_index Int?      @default(0)
  is_active   Boolean?  @default(true)
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @db.Timestamp(6)
}

model jadwal_ibadah {
  id           String    @id @default(dbgenerated("'jib_' || replace(gen_random_uuid()::text, '-', '')"))
  jenis_ibadah String    @db.VarChar(50)
  tanggal      DateTime  @db.Date
  jam          DateTime  @db.Time(6)
  lokasi       String?   @db.VarChar(200)
  rumah_jemaat String?   @db.VarChar(200)
  bulan        Int
  tahun        Int
  created_by   String?
  created_at   DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  user           users?           @relation(fields: [created_by], references: [id])
  log_notifikasi log_notifikasi[]
}

model jadwal_pelayanan {
  id            String    @id @default(dbgenerated("'jpl_' || replace(gen_random_uuid()::text, '-', '')"))
  nama_kegiatan String    @db.VarChar(255)
  tanggal       DateTime  @db.Date
  pelayan       Json?
  status        String?   @default("aktif") @db.VarChar(20)
  created_at    DateTime? @default(now()) @db.Timestamp(6)
}

model jemaat {
  id                  String    @id @default(dbgenerated("'jmt_' || replace(gen_random_uuid()::text, '-', '')"))
  nama                String    @db.VarChar(150)
  tanggal_lahir       DateTime? @db.Date
  jenis_kelamin       String?   @db.Char(1)
  pendidikan_terakhir String?   @db.VarChar(10)
  kategorial          String?   @db.VarChar(20)
  sektor_id           String
  keterangan          String?   @db.Text
  created_at          DateTime? @default(now()) @db.Timestamp(6)
  deleted_at          DateTime? @db.Timestamp(6)
  tempat_lahir        String?   @db.VarChar(100)
  pekerjaan_id        String?
  pekerjaan           String?   @db.VarChar(30)

  // Relations
  sector          sectors          @relation(fields: [sektor_id], references: [id], onDelete: Cascade)
  pekerjaan_ref   pekerjaan?       @relation(fields: [pekerjaan_id], references: [id])
  jemaat_sakramen jemaat_sakramen?
  jemaat_history  jemaat_history[]
}

model jemaat_history {
  id         String    @id @default(dbgenerated("'jmh_' || replace(gen_random_uuid()::text, '-', '')"))
  jemaat_id  String?
  perubahan  String?   @db.Text
  changed_by String?
  changed_at DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  jemaat jemaat? @relation(fields: [jemaat_id], references: [id])
}

model jemaat_sakramen {
  id         String    @id @default(dbgenerated("'jms_' || replace(gen_random_uuid()::text, '-', '')"))
  jemaat_id  String?   @unique
  bpts       Boolean?  @default(false)
  sidi       Boolean?  @default(false)
  nikah      Boolean?  @default(false)
  meninggal  Boolean?  @default(false)
  updated_at DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  jemaat jemaat? @relation(fields: [jemaat_id], references: [id], onDelete: Cascade)
}

model kegiatan_bulanan {
  id         String    @id @default(dbgenerated("'kgb_' || replace(gen_random_uuid()::text, '-', '')"))
  bulan      Int
  tahun      Int
  deskripsi  String?   @db.Text
  created_by String?
  created_at DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  user users? @relation(fields: [created_by], references: [id])
}

model keuangan_laporan {
  id                String    @id @default(dbgenerated("'klp_' || replace(gen_random_uuid()::text, '-', '')"))
  periode_awal      DateTime  @db.Date
  periode_akhir     DateTime  @db.Date
  tanggal_transaksi DateTime  @db.Date
  urutan            Int
  keterangan        String    @db.Text
  jenis_transaksi   String    @db.VarChar(20)
  kas_penerimaan    Decimal?  @default(0) @db.Decimal(15, 2)
  kas_pengeluaran   Decimal?  @default(0) @db.Decimal(15, 2)
  bank_debit        Decimal?  @default(0) @db.Decimal(15, 2)
  bank_kredit       Decimal?  @default(0) @db.Decimal(15, 2)
  created_by        String?
  created_at        DateTime? @default(now()) @db.Timestamp(6)
}

model laporan_keuangan {
  id              String    @id @default(dbgenerated("'lkn_' || replace(gen_random_uuid()::text, '-', '')"))
  tanggal         DateTime  @db.Date
  keterangan      String    @db.Text
  kas_penerimaan  Decimal?  @default(0) @db.Decimal(15, 2)
  kas_pengeluaran Decimal?  @default(0) @db.Decimal(15, 2)
  bank_debit      Decimal?  @default(0) @db.Decimal(15, 2)
  bank_kredit     Decimal?  @default(0) @db.Decimal(15, 2)
  created_by      String?
  created_at      DateTime? @default(now()) @db.Timestamp(6)
  updated_at      DateTime? @default(now()) @db.Timestamp(6)
}

model log_notifikasi {
  id         String    @id @default(dbgenerated("'lgn_' || replace(gen_random_uuid()::text, '-', '')"))
  jadwal_id  String?
  no_hp      String?   @db.VarChar(20)
  status     String?   @default("terkirim") @db.VarChar(10)
  created_at DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  jadwal_ibadah jadwal_ibadah? @relation(fields: [jadwal_id], references: [id], onDelete: Cascade)
}

model pekerjaan {
  id             String    @id @default(dbgenerated("'pkj_' || replace(gen_random_uuid()::text, '-', '')"))
  nama_pekerjaan String    @unique @db.VarChar(100)
  created_at     DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  jemaat jemaat[]
}

model pengumuman {
  id         String    @id @default(dbgenerated("'pgm_' || replace(gen_random_uuid()::text, '-', '')"))
  judul      String    @db.VarChar(200)
  isi        String    @db.Text
  created_by String?
  created_at DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  user users? @relation(fields: [created_by], references: [id])
}

model pewartaan {
  id             String    @id @default(dbgenerated("'pwt_' || replace(gen_random_uuid()::text, '-', '')"))
  judul          String    @db.VarChar(255)
  tanggal_ibadah DateTime  @db.Date
  hari           String?   @db.VarChar(50)
  tempat_jemaat  String?   @db.VarChar(255)
  ayat_firman    String?   @db.Text
  tema_khotbah   String?   @db.VarChar(255)
  status         String?   @default("draft") @db.VarChar(50)
  created_at     DateTime? @default(now()) @db.Timestamp(6)
  updated_at     DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  tata_ibadah          pewartaan_tata_ibadah[]
  pokok_doa            pewartaan_pokok_doa[]
  jemaat_ultah         pewartaan_jemaat_ultah[]
  jemaat_sakit         pewartaan_jemaat_sakit[]
  pemulihan            pewartaan_pemulihan[]
  lansia               pewartaan_lansia[]
  info_ibadah          pewartaan_info_ibadah[]
  pelayanan_sektor     pewartaan_pelayanan_sektor[]
  pelayanan_kategorial pewartaan_pelayanan_kategorial[]
}

model pewartaan_tata_ibadah {
  id           String  @id @default(dbgenerated("'pti_' || replace(gen_random_uuid()::text, '-', '')"))
  pewartaan_id String?
  urutan       Int?
  nama_bagian  String? @db.VarChar(255)
  keterangan   String? @db.Text
  judul_pujian String? @db.VarChar(255)
  isi_konten   String? @db.Text

  // Relations
  pewartaan pewartaan? @relation(fields: [pewartaan_id], references: [id], onDelete: Cascade)
}

model pewartaan_pokok_doa {
  id           String  @id @default(dbgenerated("'ppd_' || replace(gen_random_uuid()::text, '-', '')"))
  pewartaan_id String?
  kategori     String? @db.VarChar(255)
  keterangan   String? @db.Text

  // Relations
  pewartaan pewartaan? @relation(fields: [pewartaan_id], references: [id], onDelete: Cascade)
}

model pewartaan_jemaat_ultah {
  id           String    @id @default(dbgenerated("'pju_' || replace(gen_random_uuid()::text, '-', '')"))
  pewartaan_id String?
  tanggal      DateTime? @db.Date
  nama_jemaat  String?   @db.VarChar(255)
  keterangan   String?   @db.Text

  // Relations
  pewartaan pewartaan? @relation(fields: [pewartaan_id], references: [id], onDelete: Cascade)
}

model pewartaan_jemaat_sakit {
  id           String  @id @default(dbgenerated("'pjs_' || replace(gen_random_uuid()::text, '-', '')"))
  pewartaan_id String?
  nama_jemaat  String? @db.VarChar(255)
  keterangan   String? @db.Text

  // Relations
  pewartaan pewartaan? @relation(fields: [pewartaan_id], references: [id], onDelete: Cascade)
}

model pewartaan_pemulihan {
  id           String  @id @default(dbgenerated("'ppm_' || replace(gen_random_uuid()::text, '-', '')"))
  pewartaan_id String?
  nama_jemaat  String? @db.VarChar(255)
  keterangan   String? @db.Text

  // Relations
  pewartaan pewartaan? @relation(fields: [pewartaan_id], references: [id], onDelete: Cascade)
}

model pewartaan_lansia {
  id           String  @id @default(dbgenerated("'pla_' || replace(gen_random_uuid()::text, '-', '')"))
  pewartaan_id String?
  nama_jemaat  String? @db.VarChar(255)
  keterangan   String? @db.Text

  // Relations
  pewartaan pewartaan? @relation(fields: [pewartaan_id], references: [id], onDelete: Cascade)
}

model pewartaan_info_ibadah {
  id           String    @id @default(dbgenerated("'pii_' || replace(gen_random_uuid()::text, '-', '')"))
  pewartaan_id String?
  tanggal      DateTime? @db.Date
  jam          String?   @db.VarChar(50)
  jenis_ibadah String?   @db.VarChar(255)
  pemimpin     String?   @db.VarChar(255)
  sektor       String?   @db.VarChar(100)

  // Relations
  pewartaan pewartaan? @relation(fields: [pewartaan_id], references: [id], onDelete: Cascade)
}

model pewartaan_pelayanan_sektor {
  id           String  @id @default(dbgenerated("'pps_' || replace(gen_random_uuid()::text, '-', '')"))
  pewartaan_id String?
  nomor_sektor String? @db.VarChar(50)
  tempat       String? @db.VarChar(255)
  pemimpin     String? @db.VarChar(255)
  liturgos     String? @db.VarChar(255)
  nomor_hp     String? @db.VarChar(50)

  // Relations
  pewartaan pewartaan? @relation(fields: [pewartaan_id], references: [id], onDelete: Cascade)
}

model pewartaan_pelayanan_kategorial {
  id                 String  @id @default(dbgenerated("'ppk_' || replace(gen_random_uuid()::text, '-', '')"))
  pewartaan_id       String?
  tanggal_waktu      String? @db.VarChar(100)
  kategori_pelayanan String? @db.VarChar(255)
  tempat             String? @db.VarChar(255)
  pemimpin           String? @db.VarChar(255)
  liturgos_petugas   String? @db.VarChar(255)

  // Relations
  pewartaan pewartaan? @relation(fields: [pewartaan_id], references: [id], onDelete: Cascade)
}

model program_kegiatan_gereja {
  id                String    @id @default(dbgenerated("'pkg_' || replace(gen_random_uuid()::text, '-', '')"))
  bidang            String    @db.VarChar(50)
  sub_bidang        String?   @db.VarChar(100)
  nama_program      String    @db.VarChar(255)
  jenis_kegiatan    String    @db.VarChar(255)
  volume            Int?      @default(1)
  waktu_pelaksanaan String    @db.VarChar(100)
  rencana_biaya     Decimal?  @default(0) @db.Decimal(15, 2)
  keterangan        String?   @db.Text
  created_at        DateTime? @default(now()) @db.Timestamp(6)
  updated_at        DateTime? @default(now()) @db.Timestamp(6)
}

model renungan_mingguan {
  id         String    @id @default(dbgenerated("'rnm_' || replace(gen_random_uuid()::text, '-', '')"))
  judul      String    @db.VarChar(255)
  isi        String    @db.Text
  tanggal    DateTime? @default(dbgenerated("CURRENT_DATE")) @db.Date
  gambar     String?   @db.VarChar(255)
  created_at DateTime? @default(now()) @db.Timestamp(6)
}

model sectors {
  id          String    @id @default(dbgenerated("'sct_' || replace(gen_random_uuid()::text, '-', '')"))
  nama_sektor String    @db.VarChar(100)
  alamat      String?   @db.Text
  no_hp       String    @db.VarChar(20)
  created_at  DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  jemaat jemaat[]
}

model sejarah {
  id                String    @id @default(dbgenerated("'sjr_' || replace(gen_random_uuid()::text, '-', '')"))
  judul             String    @db.VarChar(255)
  tanggal_peristiwa DateTime? @db.Date
  deskripsi         String    @db.Text
  gambar_url        String?   @db.Text
  created_at        DateTime? @default(now()) @db.Timestamp(6)
  updated_at        DateTime? @default(now()) @db.Timestamp(6)
}

model sejarah_gereja {
  id         String    @id @default(dbgenerated("'sjg_' || replace(gen_random_uuid()::text, '-', '')"))
  konten     String    @db.Text
  updated_by String?
  updated_at DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  user users? @relation(fields: [updated_by], references: [id])
}

// ==================== WARTA IBADAH GROUP ====================

model warta_ibadah {
  id           String    @id @default(dbgenerated("'wib_' || replace(gen_random_uuid()::text, '-', '')"))
  judul_warta  String    @db.VarChar(255)
  hari         String?   @db.VarChar(50)
  tanggal      DateTime  @db.Date
  tempat       String?   @db.VarChar(150)
  ayat_firman  String?   @db.VarChar(255)
  tema_khotbah String?   @db.Text
  created_by   String?
  created_at   DateTime? @default(now()) @db.Timestamp(6)
  updated_at   DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  tata_ibadah          warta_tata_ibadah[]
  pokok_doa            warta_pokok_doa[]
  ulang_tahun          warta_ulang_tahun[]
  jemaat_sakit         warta_jemaat_sakit[]
  pemulihan            warta_pemulihan[]
  lansia               warta_lansia[]
  informasi_ibadah     warta_informasi_ibadah[]
  pelayanan_sektor     warta_pelayanan_sektor[]
  pelayanan_kategorial warta_pelayanan_kategorial[]
}

model warta_tata_ibadah {
  id          String    @id @default(dbgenerated("'wti_' || replace(gen_random_uuid()::text, '-', '')"))
  warta_id    String?
  urutan      Int
  nama_bagian String?   @db.VarChar(150)
  keterangan  String?   @db.VarChar(100)
  judul_lagu  String?   @db.VarChar(150)
  isi         String?   @db.Text
  created_at  DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  warta warta_ibadah? @relation(fields: [warta_id], references: [id], onDelete: Cascade)
}

model warta_pokok_doa {
  id         String  @id @default(dbgenerated("'wpd_' || replace(gen_random_uuid()::text, '-', '')"))
  warta_id   String?
  kategori   String? @db.VarChar(100)
  keterangan String? @db.Text

  // Relations
  warta warta_ibadah? @relation(fields: [warta_id], references: [id], onDelete: Cascade)
}

model warta_ulang_tahun {
  id         String    @id @default(dbgenerated("'wut_' || replace(gen_random_uuid()::text, '-', '')"))
  warta_id   String?
  tanggal    DateTime? @db.Date
  nama       String?   @db.VarChar(150)
  keterangan String?   @db.Text

  // Relations
  warta warta_ibadah? @relation(fields: [warta_id], references: [id], onDelete: Cascade)
}

model warta_jemaat_sakit {
  id         String  @id @default(dbgenerated("'wjs_' || replace(gen_random_uuid()::text, '-', '')"))
  warta_id   String?
  nama       String? @db.VarChar(150)
  keterangan String? @db.Text

  // Relations
  warta warta_ibadah? @relation(fields: [warta_id], references: [id], onDelete: Cascade)
}

model warta_pemulihan {
  id         String  @id @default(dbgenerated("'wpm_' || replace(gen_random_uuid()::text, '-', '')"))
  warta_id   String?
  nama       String? @db.VarChar(150)
  keterangan String? @db.Text

  // Relations
  warta warta_ibadah? @relation(fields: [warta_id], references: [id], onDelete: Cascade)
}

model warta_lansia {
  id         String  @id @default(dbgenerated("'wln_' || replace(gen_random_uuid()::text, '-', '')"))
  warta_id   String?
  nama       String? @db.VarChar(150)
  keterangan String? @db.Text

  // Relations
  warta warta_ibadah? @relation(fields: [warta_id], references: [id], onDelete: Cascade)
}

model warta_informasi_ibadah {
  id           String    @id @default(dbgenerated("'wii_' || replace(gen_random_uuid()::text, '-', '')"))
  warta_id     String?
  tanggal      DateTime? @db.Date
  jam          String?   @db.VarChar(20)
  jenis_ibadah String?   @db.VarChar(100)
  pemimpin     String?   @db.VarChar(100)
  sektor       String?   @db.VarChar(100)

  // Relations
  warta warta_ibadah? @relation(fields: [warta_id], references: [id], onDelete: Cascade)
}

model warta_pelayanan_sektor {
  id       String  @id @default(dbgenerated("'wps_' || replace(gen_random_uuid()::text, '-', '')"))
  warta_id String?
  sektor   String? @db.VarChar(50)
  tempat   String? @db.VarChar(150)
  pemimpin String? @db.VarChar(100)
  liturgos String? @db.VarChar(100)
  no_hp    String? @db.VarChar(20)

  // Relations
  warta warta_ibadah? @relation(fields: [warta_id], references: [id], onDelete: Cascade)
}

model warta_pelayanan_kategorial {
  id           String  @id @default(dbgenerated("'wpk_' || replace(gen_random_uuid()::text, '-', '')"))
  warta_id     String?
  hari_tanggal String? @db.VarChar(100)
  kategori     String? @db.VarChar(100)
  tempat       String? @db.VarChar(150)
  pemimpin     String? @db.VarChar(100)
  liturgos     String? @db.VarChar(100)

  // Relations
  warta warta_ibadah? @relation(fields: [warta_id], references: [id], onDelete: Cascade)
}
